modified by 2ndary with major chagnes
